(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.noteMidi=factory()})(this,function(){"use strict";var isArr=Array.isArray;var isStr=function isStr(s){return typeof s==="string"};var FIFTHS=[0,2,4,-1,1,3,5];var fifths=function fifths(letter,alt){return FIFTHS[letter]+7*alt};var fifthsOcts=function fifthsOcts(f){return Math.floor(f*7/12)};function octaves(letter,alt,oct){return oct-fifthsOcts(FIFTHS[letter])-4*alt}function pitch(letter,alt,oct){return!oct&&oct!==0?[fifths(letter,alt)]:[fifths(letter,alt),octaves(letter,alt,oct)]}var PITCH_REGEX=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d{0,1})$/;var letterIndex=function letterIndex(l){return"CDEFGAB".indexOf(l.toUpperCase())};function accToAlt(acc){var alt=acc.replace(/x/g,"##").length;return acc[0]==="b"?-alt:alt}function pitchParse(str){var m=PITCH_REGEX.exec(str);if(!m)return null;var li=letterIndex(m[1]);var alt=accToAlt(m[2]);var oct=m[3]?+m[3]:null;return pitch(li,alt,oct)}function tryParser(parser){return function(obj){return isStr(obj)?parser(obj)||obj:obj}}var tryPitch=tryParser(pitchParse);var prop=function prop(fn){return function(obj){return fn(tryPitch(obj))}};function hasOct(p){return isArr(p)&&typeof p[1]!=="undefined"}var height=function height(p){return p[0]*7+12*p[1]};var isMidi=function isMidi(m){return!isArr(m)&&m>0&&m<129};var midi=prop(function(p){return hasOct(p)?height(p)+12:isMidi(p)?+p:null});return midi});